---
import fs from 'fs';
import path from 'path';

export async function getStaticPaths() {
    // Only one static path: the page itself
    return [{ params: {} }];
}

const versionsDir = path.resolve('src/data/versions');
const versions = fs.readdirSync(versionsDir).sort();
const latestVersion = versions[versions.length - 1];

const filePath = path.join(versionsDir, latestVersion, 'codegen.json');
const raw = fs.readFileSync(filePath, 'utf-8');
const data = JSON.parse(raw);
const classes = data.classes;

function getRandomClass() {
    const idx = Math.floor(Math.random() * classes.length);
    return classes[idx].name;
}

const randomClass = encodeURIComponent(getRandomClass());
const redirectUrl = `/bindings-explorer/${latestVersion}/${randomClass}`;
---

<html>
    <head>
        <meta http-equiv="refresh" content={`0; url=${redirectUrl}`} />
        <script>
            window.location.replace({redirectUrl});
        </script>
    </head>
    <body>
        <p>Redirecting to a random class...</p>
        <a href={redirectUrl}>Click here if you are not redirected.</a>
    </body>
</html>